/* ============================================================================
   VIDEO GRID COMPONENT
   ============================================================================
   Responsive grid for displaying video performance cards.
   ============================================================================ */

/* Grid Container */
.video-grid {
  @apply flex flex-col gap-4;
}

.video-grid__grid {
  @apply grid gap-4;
  /* 4 cols desktop, 3 tablet, 2 mobile */
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  /* Containment for faster layout recalculation */
  contain: layout style;
}

@media (max-width: 1200px) {
  .video-grid__grid {
    grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
  }
}

@media (max-width: 768px) {
  .video-grid__grid {
    grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
  }
}

@media (max-width: 480px) {
  .video-grid__grid {
    grid-template-columns: repeat(2, 1fr);
    @apply gap-2;
  }
}

/* Video Card */
.video-card {
  @apply flex flex-col rounded-md cursor-pointer overflow-hidden;
  background: var(--color-surface-primary);
  border: 1px solid var(--color-border-secondary);
  transition: border-color var(--transition-fast), box-shadow var(--transition-fast), transform var(--transition-fast);
  /* Containment for layout performance - prevents card changes from affecting siblings */
  contain: layout style paint;
}

.video-card:hover {
  border-color: var(--color-primary);
  box-shadow: var(--shadow-md);
  transform: translateY(-2px);
}

.video-card:focus {
  @apply outline-none;
  box-shadow: 0 0 0 2px var(--color-primary-50);
}

/* Thumbnail Container - 9:16 vertical video aspect ratio */
.video-card__thumbnail-container {
  @apply relative w-full overflow-hidden;
  aspect-ratio: 9 / 16;
}

/* Video Thumbnail */
.video-thumbnail {
  @apply w-full h-full;
}

.video-thumbnail__placeholder {
  @apply w-full h-full flex items-center justify-center;
  background: var(--color-bg-secondary);
}

.video-thumbnail__icon {
  @apply w-12 h-12;
  color: var(--color-text-tertiary);
}

/* Duration Badge */
.video-card__duration {
  @apply absolute bottom-2 right-2 px-1.5 py-0.5 text-xs font-medium text-white rounded;
  background-color: rgba(0, 0, 0, 0.75);
}

/* Play Overlay */
.video-card__play-overlay {
  @apply absolute inset-0 flex items-center justify-center opacity-0;
  background-color: rgba(0, 0, 0, 0.3);
  transition: opacity var(--transition-fast);
}

.video-card:hover .video-card__play-overlay {
  @apply opacity-100;
}

.video-card__play-icon {
  @apply w-12 h-12 text-white;
  filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
}

/* Card Content */
.video-card__content {
  @apply flex flex-col gap-2 p-3;
}

/* Creator Info */
.video-card__creator {
  @apply flex items-center gap-2;
}

.creator-avatar-mini {
  @apply w-5 h-5 rounded-full object-cover;
}

.creator-avatar-mini--placeholder {
  @apply flex items-center justify-center;
  background: var(--color-bg-tertiary);
  color: var(--color-text-tertiary);
}

.creator-avatar-mini--placeholder svg {
  @apply w-3 h-3;
}

.video-card__username {
  @apply text-xs truncate;
  color: var(--color-text-secondary);
}

.video-card__username--link {
  @apply no-underline transition-colors duration-150;
}

.video-card__username--link:hover {
  color: var(--color-text-primary);
  text-decoration: underline;
}

/* Title */
.video-card__title {
  @apply text-sm font-medium m-0 line-clamp-2;
  color: var(--color-text-primary);
  min-height: 2.5em;
}

/* Metrics Grid */
.video-card__metrics {
  @apply grid grid-cols-5 gap-1;
}

.video-card__metric {
  @apply flex flex-col items-center text-center;
}

.video-card__metric--gmv .video-card__metric-value {
  @apply font-semibold;
  color: var(--color-accent-green);
}

.video-card__metric-value {
  @apply text-sm font-medium;
  color: var(--color-text-primary);
}

.video-card__metric-label {
  @apply text-xs;
  color: var(--color-text-tertiary);
}

/* Footer */
.video-card__footer {
  @apply flex items-center justify-between text-xs pt-2 mt-auto;
  color: var(--color-text-secondary);
  border-top: 1px solid var(--color-border-secondary);
}

.video-card__items-sold {
  @apply font-medium;
  color: var(--color-accent-green);
}

/* TikTok Link */
.video-card__tiktok-link {
  @apply inline-flex items-center gap-1 ml-auto text-xs font-medium no-underline rounded px-1.5 py-0.5;
  color: var(--color-text-secondary);
  background: var(--color-bg-tertiary);
  transition: color var(--transition-fast), background-color var(--transition-fast);
}

.video-card__tiktok-link:hover {
  color: #fe2c55;
  background: var(--color-bg-secondary);
}

.video-card__tiktok-icon {
  @apply w-3 h-3;
}

/* Empty State */
.video-grid__empty {
  @apply flex flex-col items-center justify-center py-16 text-center;
}

.video-grid__empty-icon {
  @apply w-16 h-16 mb-4;
  color: var(--color-text-tertiary);
}

.video-grid__empty-title {
  @apply text-lg font-medium mb-1;
  color: var(--color-text-primary);
}

.video-grid__empty-description {
  @apply text-sm;
  color: var(--color-text-secondary);
}

/* Loader */
.video-grid__loader {
  @apply flex items-center justify-center gap-2 py-8;
  color: var(--color-text-secondary);
}

/* ============================================================================
   VIDEO FILTERS
   ============================================================================ */

.video-filters {
  @apply flex flex-wrap items-center justify-between gap-4 mb-6;
  padding-top: var(--space-5);
}

.video-filters__left {
  @apply flex items-center gap-3 flex-1;
}

.video-filters__right {
  @apply flex items-center justify-end gap-2;
}

.video-filters__presets {
  @apply flex items-center gap-1;
  flex-direction: row-reverse;
}

.video-filters__sort-label {
  @apply text-sm text-text-secondary font-medium whitespace-nowrap;
}

.video-filters__search-wrapper {
  @apply relative flex-1 min-w-[200px] max-w-[400px];
}

.video-filters__creator,
.video-filters__sort {
  @apply shrink-0;
}

/* Mobile Responsive */
@media (max-width: 640px) {
  .video-filters {
    @apply flex-col items-stretch gap-3;
  }

  .video-filters__left,
  .video-filters__right {
    @apply w-full;
  }

  .video-filters__right {
    @apply justify-start flex-wrap;
  }

  .video-filters__search-wrapper {
    @apply max-w-none;
  }

  .video-card__metrics {
    @apply grid-cols-2 gap-2;
  }

  .video-card__content {
    @apply p-2;
  }
}

/* ============================================================================
   VIDEOS PAGE
   ============================================================================ */

.videos-index {
  @apply min-h-screen;
}

.videos-count {
  @apply absolute text-xs text-text-secondary font-medium whitespace-nowrap;
  bottom: 100%;
  left: 2px;
  margin-bottom: var(--space-1);
}

/* ============================================================================
   VIDEO THUMBNAIL IMAGE
   ============================================================================ */

.video-thumbnail__image {
  @apply absolute inset-0 w-full h-full object-cover;
}

/* ============================================================================
   VIDEO HOVER PLAYER
   ============================================================================
   Fixed overlay that appears when hovering over a video card.
   Centered in viewport with 9:16 aspect ratio player.
   ============================================================================ */

/* Container - fixed centered overlay */
.video-hover-player {
  @apply fixed inset-0 flex items-center justify-center;
  z-index: var(--z-modal);
  pointer-events: none;
}

/* Hidden state */
.video-hover-player--hidden {
  @apply invisible;
}

/* Backdrop - dimmed background (shared with modal) */
.video-hover-player__backdrop {
  @apply fixed inset-0;
  background-color: var(--color-backdrop);
  opacity: 1;
  transition: opacity var(--transition-fast);
  /* No pointer events on desktop - allows hover to work through backdrop */
  pointer-events: none;
}

.video-hover-player--hidden .video-hover-player__backdrop {
  opacity: 0;
}

/* Enable backdrop click on touch devices for tap-to-dismiss */
@media (hover: none) {
  .video-hover-player__backdrop {
    pointer-events: auto;
  }
}

/* Also enable on narrow screens (likely mobile) */
@media (max-width: 768px) {
  .video-hover-player__backdrop {
    pointer-events: auto;
  }
}

/* Wrapper for positioning close button outside video */
.video-hover-player__wrapper {
  @apply relative;
  pointer-events: auto;
  z-index: 1;
  opacity: 1;
  transform: scale(1);
  transition: opacity var(--transition-fast), transform var(--transition-fast);
}

.video-hover-player--hidden .video-hover-player__wrapper {
  opacity: 0;
  transform: scale(0.95);
}

/* Player container - 9:16 vertical video */
.video-hover-player__container {
  @apply relative overflow-hidden rounded-lg shadow-2xl;
  background: var(--color-bg-tertiary);
  aspect-ratio: 9 / 16;
  height: min(70vh, 600px);
}

/* Close button - positioned above top-right corner of video */
.video-hover-player__close {
  @apply absolute z-10;
  @apply w-10 h-10 p-2;
  @apply flex items-center justify-center;
  @apply rounded-full;
  @apply text-white bg-black/50 border-none cursor-pointer;
  @apply opacity-0 pointer-events-none;
  right: 0;
  bottom: 100%;
  margin-bottom: 0.5rem;
  transition: opacity var(--transition-fast), background-color var(--transition-fast);
}

.video-hover-player__close svg {
  @apply w-5 h-5;
}

.video-hover-player__close:hover {
  background-color: rgba(0, 0, 0, 0.7);
}

/* Show close button on touch devices (no hover capability) */
@media (hover: none) {
  .video-hover-player__close {
    @apply opacity-100 pointer-events-auto;
  }
}

/* Also show close button on narrow screens (likely mobile) */
@media (max-width: 768px) {
  .video-hover-player__close {
    @apply opacity-100 pointer-events-auto;
  }
}

/* TikTok iframe player */
.tiktok-player {
  @apply absolute inset-0 w-full h-full border-0;
}

/* TikTok player loading state - skeleton loader */
.tiktok-player-loading {
  @apply absolute inset-0 flex items-center justify-center;
  background: var(--color-bg-tertiary);
}

.tiktok-player-loading__spinner {
  @apply w-10 h-10;
  color: var(--color-text-tertiary);
  animation: spin 1s linear infinite;
}

/* TikTok player fallback */
.tiktok-player-fallback {
  @apply absolute inset-0 flex flex-col items-center justify-center gap-4 p-6 text-center;
  background: var(--color-bg-tertiary);
}

.tiktok-player-fallback svg {
  opacity: 0.5;
  color: var(--color-text-tertiary);
}

.tiktok-player-fallback p {
  @apply m-0 text-sm;
  color: var(--color-text-secondary);
}

.tiktok-player-fallback__link {
  @apply inline-flex items-center gap-2 px-5 py-2.5 text-sm font-medium text-white no-underline rounded-md;
  background: #fe2c55;
  transition: opacity var(--transition-fast);
}

.tiktok-player-fallback__link:hover {
  opacity: 0.9;
}

/* Mobile responsive */
@media (max-width: 640px) {
  .video-hover-player__container {
    height: min(70vh, 500px);
    @apply rounded-md;
  }

  .video-hover-player__close {
    @apply w-9 h-9;
    margin-bottom: 0.375rem;
  }
}
