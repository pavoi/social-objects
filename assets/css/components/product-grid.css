/* ============================================================================
   PRODUCT GRID COMPONENT - Tailwind Migration
   ============================================================================
   Reusable grid for displaying products in different contexts (browse/select).
   Uses @apply for base styles while maintaining existing class API.
   ============================================================================ */

.product-grid {
  @apply flex flex-col gap-4;
}

.product-grid__header {
  @apply flex flex-col gap-3 pb-3 mb-4;
  border-bottom: 1px solid var(--color-border-secondary);
}

/* Match modal background for select mode - no divider */
.product-grid--select .product-grid__header {
  @apply bg-surface-primary border-b-0 pb-0 mb-3;
}

/* Match page background for browse mode */
.product-grid--browse .product-grid__header {
  @apply bg-bg-primary flex-row items-center flex-wrap gap-4;
}

.product-grid__controls {
  @apply flex gap-2 w-full flex-wrap;
}

.product-grid__search {
  @apply flex-1 min-w-[200px] max-w-[400px];
}

/* Dark background for search in select mode (modals) */
.product-grid--select .product-grid__search .input {
  @apply bg-bg-secondary;
}

.product-grid__sort {
  @apply shrink-0 min-w-[180px];
}

.product-grid__status {
  @apply flex items-center gap-4 shrink-0;
}

.product-grid__count {
  @apply text-text-secondary font-normal text-base whitespace-nowrap shrink-0;
}

.product-grid__enter-hint {
  @apply text-text-tertiary text-sm whitespace-nowrap shrink-0;
}

@media (max-width: 480px) {
  .product-grid__header {
    @apply flex-col items-stretch gap-2;
  }

  .product-grid__status {
    @apply justify-between;
  }
}

/* ============================================================================
   SELECT MODE - For product selection (modal, smaller cards)
   ============================================================================ */

.product-grid--select .product-grid__grid {
  @apply grid gap-3 p-2 rounded-md bg-surface-primary min-h-min;
  grid-template-columns: repeat(auto-fill, minmax(120px, 140px));
  border: 1px solid var(--color-border-secondary);
}

.product-card-select {
  @apply relative flex flex-col items-center gap-2 p-3 bg-bg-secondary rounded-md cursor-pointer;
  border: 2px solid var(--color-border-secondary);
  transition: all var(--transition-fast);
}

.product-card-select:hover {
  @apply border-primary shadow-sm;
  transform: translateY(-2px);
}

.product-card-select--selected {
  @apply border-primary bg-primary-50 shadow-md;
}

.product-card-select__checkmark {
  @apply absolute top-2 right-2 z-10 flex items-center justify-center w-6 h-6 bg-accent-green text-white rounded-full font-bold;
  box-shadow: 0 2px 8px color-mix(in srgb, var(--color-accent-green) 40%, transparent);
  transition: opacity var(--transition-fast);
}

.product-card-select__checkmark--hidden {
  @apply opacity-0 pointer-events-none;
}

.product-card-select__image {
  @apply w-full rounded-sm bg-bg-tertiary;
  aspect-ratio: 1;
  object-fit: contain;
}

.product-card-select__image-placeholder {
  @apply w-full flex items-center justify-center bg-bg-tertiary rounded-sm text-text-tertiary text-xs;
  aspect-ratio: 1;
}

.product-card-select__name {
  @apply text-sm font-medium text-center m-0 overflow-hidden;
  line-height: 1.2;
  text-overflow: ellipsis;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  line-clamp: 2;
  -webkit-box-orient: vertical;
}

/* ============================================================================
   BROWSE MODE - For browsing/editing products (/products page, larger cards)
   ============================================================================ */

.product-grid--browse .product-grid__grid {
  @apply grid gap-4 p-0;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
}

.product-card-browse {
  @apply flex flex-col bg-surface-primary rounded-md cursor-pointer overflow-hidden;
  border: 1px solid var(--color-border-secondary);
  transition: border-color var(--transition-fast), box-shadow var(--transition-fast);
  animation: fadeInSlideUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) both;
}

.product-card-browse:hover {
  @apply border-primary shadow-md;
  transform: translateY(-2px);
}

.product-card-browse__image {
  @apply w-full block bg-bg-tertiary;
  aspect-ratio: 1;
  object-fit: contain;
}

.product-card-browse__image-placeholder {
  @apply w-full flex items-center justify-center bg-bg-tertiary text-text-tertiary text-xs;
  aspect-ratio: 1;
}

.product-card-browse__info {
  @apply p-3 flex flex-col gap-2;
}

.product-card-browse__name {
  @apply text-base font-medium m-0;
  line-height: 1.3;
}

.product-card-browse__pricing {
  @apply flex items-center gap-2 text-sm;
}

.product-card-browse__price {
  @apply text-text-primary font-semibold;
}

.product-card-browse__price-original {
  @apply text-text-secondary line-through;
  text-decoration-thickness: 1px;
  text-underline-offset: 2px;
}

.product-card-browse__price-sale {
  @apply text-accent-red font-semibold;
}

/* Image container for position overlay */
.product-card-browse__image-container {
  @apply relative w-full;
}

/* Position badge overlay */
.product-card-browse__position {
  @apply absolute top-2 left-2 min-w-8 h-8 px-2 flex items-center justify-center text-white text-lg font-bold rounded-sm z-[2];
  background-color: rgba(0, 0, 0, 0.7);
}

/* Sample count badge - positioned top right over image */
.product-card-browse__sample-badge {
  @apply absolute top-2 right-2 z-[2];
  @apply inline-flex items-center px-2 py-1;
  @apply text-xs font-medium rounded-full;
  background: rgba(0, 0, 0, 0.7);
  color: white;
}

/* ============================================================================
   SHARED STYLES
   ============================================================================ */

.product-grid__grid {
  @apply grid w-full;
}

.product-grid__empty {
  @apply text-center text-text-secondary p-8;
  grid-column: 1 / -1;
}

.product-grid__loader {
  @apply flex justify-center;
  grid-column: 1 / -1;
}

/* Disable animation when searching for instant results */
.product-grid--searching .product-card-browse {
  @apply opacity-100;
  animation: none;
  transform: translateY(0);
}

/* Custom infinite scroll trigger element */
infinite-scroll-trigger {
  @apply flex justify-center p-4;
  grid-column: 1 / -1;
}

.product-grid__loading-indicator {
  @apply flex flex-col items-center gap-2 text-text-secondary text-sm;
}

/* Note: @keyframes fadeInSlideUp is defined in card.css */

/* ============================================================================
   CONTEXT MENU
   ============================================================================ */

.product-context-menu {
  @apply fixed min-w-[160px] p-1 bg-surface-primary rounded-md shadow-lg z-[1000];
  border: 1px solid var(--color-border-secondary);
}

.product-context-menu__item {
  @apply flex items-center gap-2 w-full py-2 px-3 text-sm text-text-primary bg-transparent border-0 rounded-sm cursor-pointer text-left;
}

.product-context-menu__item:hover {
  @apply bg-bg-secondary;
}

.product-context-menu__item svg {
  @apply w-4 h-4 shrink-0;
}

/* Mobile responsive - maximize space efficiency */
@media (max-width: 640px) {
  .product-grid {
    @apply gap-3;
  }

  .product-grid__header {
    @apply gap-2 pb-2 pt-0;
  }

  .product-grid__controls {
    @apply gap-2 flex-nowrap;
  }

  .product-grid__search {
    @apply min-w-0 max-w-full;
    flex: 1 1 100%;
  }

  .product-grid__sort {
    @apply min-w-[140px] max-w-[180px];
    flex: 0 0 auto;
  }

  /* Smaller min-width to ensure 2 columns on narrow viewports */
  .product-grid--browse .product-grid__grid {
    @apply gap-2;
    grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
  }

  /* Smaller card padding */
  .product-card-browse__info {
    @apply p-2 gap-1;
  }

  .product-card-browse__name {
    @apply text-sm;
  }

  .product-card-browse__pricing {
    @apply text-xs;
  }

  /* Smaller position badge on mobile */
  .product-card-browse__position {
    @apply min-w-7 h-7 text-base;
  }
}

/* Responsive adjustments */
@media (min-width: 640px) {
  /* Larger position badge on desktop */
  .product-card-browse__position {
    @apply min-w-9 h-9 text-xl;
  }

  .product-grid--select .product-grid__header {
    @apply flex-row items-center justify-between;
  }

  .product-grid--select .product-grid__controls {
    @apply flex-nowrap min-w-0;
    flex: 0 0 50%;
  }

  .product-grid--select .product-grid__search {
    @apply min-w-[300px] max-w-none;
  }

  .product-grid__controls {
    @apply flex-nowrap;
  }

  .product-grid__sort {
    @apply min-w-[200px];
  }

  .product-grid--browse .product-grid__grid {
    grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
  }
}
